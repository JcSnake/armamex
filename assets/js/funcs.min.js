/**
 * Global variables
 */

var isOnDebbug = true;
var version = 1.0;
var release = 1;

var NOTIFY_POS = { 'TOP_CENTER': 'top-center', 'TOP_LEFT': 'top_left', 'TOP_RIGHT': 'top_right' }
var NOTIFY_STS = { 'SUCCESS': 'success', 'FAIL': 'danger'}

/**
 * Methods
 */

$(document).ready(function() {
    setFrmStyle($(window).width());
    setButtonTopBottom($(window).width());
    setListeners();
});

$(window).resize(function() {
    setFrmStyle($(window).width());
    setButtonTopBottom($(window).width());
});

$(window).scroll(function(e) {
    if($(window).scrollTop() >= 1200) {
        $('#am-top-button')[0].classList.remove('uk-hidden');
    } else {
        $('#am-top-button')[0].classList.add('uk-hidden');
    }
});

function setListeners() {
    $('#am-top-button').click(function() {
        UIkit.Utils.scrollToElement(UIkit.$('#am-top'));
    });

    $('#am-send-contact').click(function() {
        if(validateContactForm()) {
            sendContactForm();
        }
    });

    $('#am-send-fletamentos').click(function() {
        if(validateSolicitanteForm() && validateFletamentosForm()) {
            //sendFletamentosForm();
        }
    });

    $('#am-send-trans').click(function() {
        if(validateTransMarForm()) {
            sendFletamentosForm();
        }
    });

    $('#cotizacionType').change(function() {
        var index = this.selectedIndex;
        setCotizacionFormsHide();

        switch (index) {
            case 1:
                $('#cotizacionOpt1')[0].classList.remove('uk-hidden');
                break;
            case 2:
                $('#cotizacionOpt2')[0].classList.remove('uk-hidden');
                break;
            case 3:
                $('#cotizacionOpt3')[0].classList.remove('uk-hidden');
                break;
        }

        if(index > 0) {
            UIkit.Utils.scrollToElement(UIkit.$('#am-cotizacion'), {offset: -290});
        }
    });

    $('.am-menu-link').hover(function() {
        changeNavIcon(this, true);
    }, function() {
        changeNavIcon(this, false);
    });
}

function changeNavIcon(e, isHover) {
    var img = e.firstElementChild.firstElementChild.firstElementChild;
    var src = img.src;
    var lbl = e.firstElementChild.lastElementChild;

    if(isHover) {
        img.src = src.replace('.svg', '_hover.svg');
        lbl.classList.add('am-text-menu-hover');
    } else {
        img.src = src.replace('_hover.svg', '.svg');
        lbl.classList.remove('am-text-menu-hover');
    }
}

function setButtonTopBottom(width) {
    var btnTop = $('#am-top-button')[0];

    if(width <= 767) {
        btnTop.style.bottom = "85px";
        btnTop.style.right = "10px";
        btnTop.style.height = "45px";
        btnTop.style.width = "45px";
    }  else {
        btnTop.style.bottom = "50px";
        btnTop.style.right = "10px";
        btnTop.style.height = "50px";
        btnTop.style.width = "50px";
    }
}

function setCotizacionFormsHide() {
    $('#cotizacionOpt1')[0].classList.add('uk-hidden');
    $('#cotizacionOpt2')[0].classList.add('uk-hidden');
    $('#cotizacionOpt3')[0].classList.add('uk-hidden');
}

function setFrmStyle(frameWidth) {
    if(frameWidth <= 767) {
        $('#contactFrm')[0].classList.remove('uk-form-horizontal');
        $('#solicitanteFrm')[0].classList.remove('uk-form-horizontal');
        $('#cotizacionOpt1Frm')[0].classList.remove('uk-form-horizontal');
        $('#cotizacionOpt2Frm')[0].classList.remove('uk-form-horizontal');
        $('#cotizacionOpt3Frm')[0].classList.remove('uk-form-horizontal');
    } else {
        $('#contactFrm')[0].classList.add('uk-form-horizontal');
        $('#solicitanteFrm')[0].classList.add('uk-form-horizontal');
        $('#cotizacionOpt1Frm')[0].classList.add('uk-form-horizontal');
        $('#cotizacionOpt2Frm')[0].classList.add('uk-form-horizontal');
        $('#cotizacionOpt3Frm')[0].classList.add('uk-form-horizontal');
    }
}

function validateContactForm() {
    var frmName = $('#frmName')[0];
    var frmEmail = $('#frmEmail')[0];
    var frmPhone = $('#frmPhone')[0];
    var frmMessage = $('#frmMessage')[0];
    
    var vName = validateName(frmName, frmName.value);
    var vEmail = validateEmail(frmEmail, frmEmail.value);
    var vPhone = validatePhone(frmPhone, frmPhone.value);

    if(vName && vEmail && vPhone) {
        return true;
    } else {
        showNotification(LNG.err.fail_validation, NOTIFY_STS.FAIL, NOTIFY_POS.TOP_CENTER);
        return false;
    }
}

function validateSolicitanteForm() {
    var frmName = $('#cotizacionName')[0];
    var frmEmail = $('#cotizacionEmail')[0];
    var frmService = $('#cotizacionService')[0];
    var frmPhone = $('#cotizacionPhone')[0];
    var frmFletador = $('#cotizacionFletador')[0];
    var frmQuantity = $('#cotOpt1Quantity')[0];
    var frmFleta = $('#cotOpt1Type')[0];
    var frmCapacity = $('#cotOpt1Capacity')[0];
    var frmArea = $('#cotOpt1Area')[0];
    var frmEntrega = $('#cotOpt1Entrega')[0];
    var frmPrincipal = $('#cotOpt1Principal')[0];
    var frmExtension = $('#cotOpt1Extension')[0];
    var frmEspecificaciones = $('#cotOpt1Especificaciones')[0];
    

    var vName = validateName(frmName, frmName.value);
    var vEmail = validateEmail(frmEmail, frmEmail.value);
    var vService = validateService(frmService, frmService.value);
    var vPhone = validatePhone(frmPhone, frmPhone.value);
    var vFletador = validateFletador(frmFletador, frmFletador.value);
    var vQuantity = validateQuantity (frmQuantity, frmQuantity.value);
    var vFleta = validateFleta (frmFleta, frmFleta.value);
    var vCapacity = validateCapacity (frmCapacity, frmCapacity.value);
    var vArea = validateArea(frmArea, frmArea.value);
    var vEntrega = validateEntrega(frmEntrega, frmEntrega.value);
    var vPrincipal = validatePrincipal(frmPrincipal, frmPrincipal.value);
    var vExtension = validateExtension(frmExtension, frmExtension.value);
    var vEspecificaciones = validateEspecificaciones(frmEspecificaciones, frmEspecificaciones.value);


    if(vName && vEmail && vService && vPhone && vFletador && vQuantity && vFleta && vCapacity && vArea && vEntrega && vPrincipal && vExtension && vEspecificaciones) {
        return true;
    } else {
        showNotification(LNG.err.fail_validation, NOTIFY_STS.FAIL, NOTIFY_POS.TOP_CENTER);
        return false;
    }
}

function validateTransMarForm() {
    var frmDateEm = $('#cotOpt2Salida')[0];
    var frmQuantity = $('#cotOpt2Peso')[0];
    var frmTypeCarga = $('#cotOpt2Esolra')[0];
    var frmSysCarga = $('#cotOpt2Calado')[0];
    var frmSysDes = $('#cotOptTRB')[0];
    var frmEntrada2 = $('#cotOpt2Entrada')[0];
    var frmRaOp1 = $('#cotOpt1TripulacionYes')[0];
    var frmRaOp2 = $('#cotOpt2TripulacionYes')[0];
    var frmRaOp3 = $('#cotOpt3TripulacionYes')[0];
    var frmEspecificaciones = $('#cotOpt3Especificaciones')[0];

    var vDateEm = validateDateEm(frmName, frmName.value);
    var vQuantity = validateQuantity(frmEmail, frmEmail.value);
    var vTypeCarga = validateTypeCarga(frmService, frmService.value);
    var vSysCarga = validateSysCarga(frmPhone, frmPhone.value);
    var vEntrada2 = validateEntrada2 (frmFletador, frmFletador.value);
    var vRaOp1 = validateRaOp1 (frmQuantity, frmQuantity.value);
    var vRaOp2 = validateRaOp2(frmFleta, frmFleta.value);
    var vRaOp3 = validateRaOp3 (frmQuantity, frmQuantity.value);
    var vEspecificaciones = validateEspecificaciones(frmFleta, frmFleta.value);
    
    if(vDateEm && vQuantity && vTypeCarga && vSysCarga && vEntrada2  && vRaOp1 && vRaOp2 && vRaOp3 && vEspecificaciones) {
        return true;
    } else {
        showNotification(LNG.err.fail_validation, NOTIFY_STS.FAIL, NOTIFY_POS.TOP_CENTER);
        return false;
    }
}

function validateFletamentosForm() {
    var frmQuantity = $('#cotOpt1Quantity')[0];
    var frmFleta = $('#cotOpt1Type')[0];
    var frmCapacity = $('#cotOpt1Capacity')[0];
    var frmArea = $('#cotOpt1Area')[0];
    var frmEntrega = $('#cotOpt1Entrega')[0];
    var frmPrincipal = $('#cotOpt1Principal')[0];
    var frmExtension = $('#cotOpt1Extension')[0];
    var frmEspecificaciones = $('#cotOpt1Especificaciones')[0];
    
    var vQuantity = validateQuantity (frmQuantity, frmQuantity.value);
    var vFleta = validateFleta(frmFleta, frmFleta.value);
    var vCapacity = validateCapacity(frmCapacity, frmCapacity.value);
    var vArea = validateArea(frmArea, frmArea.value);
    var vEntrega = validateEntrega(frmEntrega, frmEntrega.value);
    var vPrincipal = validatePrincipal(frmPrincipal, frmPrincipal.value);
    var vExtension = validateExtension(frmExtension, frmExtension.value);
    var vEspecificaciones = validateEspecificaciones(frmEspecificaciones, frmEspecificaciones.value);

    if(vQuantity && vTypeFleta && vCapacity && vArea && vEntrega && vPrincipal && vExtension & vEspecificaciones) {
        return true;
    } else {
        showNotification(LNG.err.fail_validation, NOTIFY_STS.FAIL, NOTIFY_POS.TOP_CENTER);
        return false;
    }
}

function validateName(objName, strName) {
    clearAlertsInForm(objName);

    if(strName != '' && strName.length >= 5 && isNaN(strName)) {
        objName.classList.add('am-form-success');
        return true;
    } else {
        objName.classList.add('am-form-danger');
        return false;
    }
}

function validateEmail(objEmail, strEmail) {
    var regex = /^(([^<>()[\]\.,;:\s@\"]+(\.[^<>()[\]\.,;:\s@\"]+)*)|(\".+\"))@(([^<>()[\]\.,;:\s@\"]+\.)+[^<>()[\]\.,;:\s@\"]{2,})$/i;
    clearAlertsInForm(objEmail);

    if(regex.test(strEmail)) {
        objEmail.classList.add('am-form-success');
        return true;
    } else {
        objEmail.classList.add('am-form-danger');
        return false;
    }
}

function validateService(objService, strService) {
    clearAlertsInForm(objService);

    if(strService != '' && strService.length === 10 && !isNaN(strService)) {
        objService.classList.add('am-form-success');
        return true;
    } else {
        objService.classList.add('am-form-danger');
        return false;
    }
}

function validatePhone(objPhone, strPhone) {
    clearAlertsInForm(objPhone);

    if(strPhone != '' && strPhone.length === 10 && !isNaN(strPhone)) {
        objPhone.classList.add('am-form-success');
        return true;
    } else {
        objPhone.classList.add('am-form-danger');
        return false;
    }
}

function validateFletador(objFletador, strFletador) {
    clearAlertsInForm(objFletador);

    if(strFletador != '' && strFletador.length === 10 && !isNaN(strFletador)) {
        objFletador.classList.add('am-form-success');
        return true;
    } else {
        objFletador.classList.add('am-form-danger');
        return false;
    }
}

function validateQuantity(objQuantity, strQuantity) {
    clearAlertsInForm(objQuantity);

    if(strQuantity != '') {
        objQuantity.classList.add('am-form-success');
        return true;
    } else {
        objQuantity.classList.add('am-form-danger');
        return false;
    }
}

function validateFleta(objFleta, strFleta) {
    clearAlertsInForm(objFleta);

    if(strFleta != '' && strFleta.length === 10 && !isNaN(strFleta)) {
        objFleta.classList.add('am-form-success');
        return true;
    } else {
        objFleta.classList.add('am-form-danger');
        return false;
    }
}

function validateCapacity(objCapacity, strCapacity) {
    clearAlertsInForm(objCapacity);

    if(strCapacity != '') {
        objCapacity.classList.add('am-form-success');
        return true;
    } else {
        objCapacity.classList.add('am-form-danger');
        return false;
    }
}

function validateArea(objArea, strArea) {
    clearAlertsInForm(objArea);

    if(strArea != '') {
        objArea.classList.add('am-form-success');
        return true;
    } else {
        objArea.classList.add('am-form-danger');
        return false;
    }
}

function validateEntrega(objEntrega, strEntrega) {
    clearAlertsInForm(objEntrega);

    if(strEntrega != '') {
        objEntrega.classList.add('am-form-success');
        return true;
    } else {
        objEntrega.classList.add('am-form-danger');
        return false;
    }
}

function validatePrincipal(objPrincipal, strPrincipal) {
    clearAlertsInForm(objPrincipal);

    if(strPrincipal != '') {
        objPrincipal.classList.add('am-form-success');
        return true;
    } else {
        objPrincipal.classList.add('am-form-danger');
        return false;
    }
}

function validateExtension(objExtension, strExtension) {
    clearAlertsInForm(objExtension);

    if(strExtension != '') {
        objExtension.classList.add('am-form-success');
        return true;
    } else {
        objExtension.classList.add('am-form-danger');
        return false;
    }
}

function validateEspecificaciones(objEspecificaciones, strEspecificaciones) {
    clearAlertsInForm(objEspecificaciones);

    if(strEspecificaciones != '') {
        objEspecificaciones.classList.add('am-form-success');
        return true;
    } else {
        objEspecificaciones.classList.add('am-form-danger');
        return false;
    }
}

function validateDateEm(objDateEm, strDateEm) {
    clearAlertsInForm(objDateEm);

    if(strDateEm != '' && strDateEm.length >= 5 && isNaN(strDateEm)) {
        objDateEm.classList.add('am-form-success');
        return true;
    } else {
        objDateEm.classList.add('am-form-danger');
        return false;
    }
}

function clearAlertsInForm(e) {
    e.classList.remove('am-form-success');
    e.classList.remove('am-form-danger');
}

function sendContactForm() {
    $('#contactForm')[0].classList.add('uk-hidden');
    $('#contactSuccess')[0].classList.remove('uk-hidden');
}

function sendCotizacionForm() {
    $('#cotizacionFrm')[0].classList.add('uk-hidden');
    //$('#contactSuccess')[0].classList.remove('uk-hidden');
}

function sendFletamentosForm() {
    $('#cotizacionFrm')[0].classList.add('uk-hidden');
    //$('#cotizacionOpt1')[0].classList.add('uk-hidden');
}

function showNotification(message, type, position) {
    UIkit.notify(message, {status: type, timeout: 3000, position: position});
}