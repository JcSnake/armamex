/**
 * Global variables
 */

var isOnDebbug = true;
var version = 1.0;
var release = 1;

var NOTIFY_POS = { 'TOP_CENTER': 'top-center', 'TOP_LEFT': 'top_left', 'TOP_RIGHT': 'top_right' }
var NOTIFY_STS = { 'SUCCESS': 'success', 'FAIL': 'danger'}

/**
 * Methods
 */

$(document).ready(function() {
    setFrmStyle($(window).width());
    setButtonTopBottom($(window).width());
    setListeners();
});

$(window).resize(function() {
    setFrmStyle($(window).width());
    setButtonTopBottom($(window).width());
});

$(window).scroll(function(e) {
    if($(window).scrollTop() >= 1200) {
        $('#am-top-button')[0].classList.remove('uk-hidden');
    } else {
        $('#am-top-button')[0].classList.add('uk-hidden');
    }
});

function setListeners() {
    $('#am-top-button').click(function() {
        UIkit.Utils.scrollToElement(UIkit.$('#am-top'));
    });

    $('#am-send-contact').click(function() {
        if(validateContactForm()) {
            sendContactForm();
        }
    });

    $('.am-send-cotizacion').click(function() {
        UIkit.notify({
            message: 'Gracias por enviar tu solicitud.',
            status: 'success',
            timeout: 5000,
            pos: 'top-center'
        });
    });

    $('#cotizacionType').change(function() {
        var index = this.selectedIndex;
        setCotizacionFormsHide();

        switch (index) {
            case 1:
                $('#cotizacionOpt1')[0].classList.remove('uk-hidden');
                break;
            case 2:
                $('#cotizacionOpt2')[0].classList.remove('uk-hidden');
                break;
            case 3:
                $('#cotizacionOpt3')[0].classList.remove('uk-hidden');
                break;
        }

        if(index > 0) {
            UIkit.Utils.scrollToElement(UIkit.$('#am-cotizacion'), {offset: -350});
        }
    });
}

function setButtonTopBottom(width) {
    var btnTop = $('#am-top-button')[0];

    if(width <= 767) {
        btnTop.style.bottom = "85px";
        btnTop.style.right = "10px";
        btnTop.style.height = "45px";
        btnTop.style.width = "45px";
    }  else {
        btnTop.style.bottom = "50px";
        btnTop.style.right = "10px";
        btnTop.style.height = "50px";
        btnTop.style.width = "50px";
    }
}

function setCotizacionFormsHide() {
    $('#cotizacionOpt1')[0].classList.add('uk-hidden');
    $('#cotizacionOpt2')[0].classList.add('uk-hidden');
    $('#cotizacionOpt3')[0].classList.add('uk-hidden');
}

function setFrmStyle(frameWidth) {
    if(frameWidth <= 767) {
        $('#contactFrm')[0].classList.remove('uk-form-horizontal');
        $('#solicitanteFrm')[0].classList.remove('uk-form-horizontal');
        $('#cotizacionOpt1Frm')[0].classList.remove('uk-form-horizontal');
        $('#cotizacionOpt2Frm')[0].classList.remove('uk-form-horizontal');
        $('#cotizacionOpt3Frm')[0].classList.remove('uk-form-horizontal');
    } else {
        $('#contactFrm')[0].classList.add('uk-form-horizontal');
        $('#solicitanteFrm')[0].classList.add('uk-form-horizontal');
        $('#cotizacionOpt1Frm')[0].classList.add('uk-form-horizontal');
        $('#cotizacionOpt2Frm')[0].classList.add('uk-form-horizontal');
        $('#cotizacionOpt3Frm')[0].classList.add('uk-form-horizontal');
    }
}

function validateContactForm() {
    var frmName = $('#frmName')[0];
    var frmEmail = $('#frmEmail')[0];
    var frmPhone = $('#frmPhone')[0];
    var frmMessage = $('#frmMessage')[0];
    
    var vName = validateName(frmName, frmName.value);
    var vEmail = validateEmail(frmEmail, frmEmail.value);
    var vPhone = validatePhone(frmPhone, frmPhone.value);

    if(vName && vEmail && vPhone) {
        return true;
    } else {
        showNotification(LNG.err.fail_validation, NOTIFY_STS.FAIL, NOTIFY_POS.TOP_CENTER);
        return false;
    }
}

function validateName(objName, strName) {
    clearAlertsInForm(objName);

    if(strName != '' && strName.length >= 5 && isNaN(strName)) {
        objName.classList.add('am-form-success');
        return true;
    } else {
        objName.classList.add('am-form-danger');
        return false;
    }
}

function validateEmail(objEmail, strEmail) {
    var regex = /^(([^<>()[\]\.,;:\s@\"]+(\.[^<>()[\]\.,;:\s@\"]+)*)|(\".+\"))@(([^<>()[\]\.,;:\s@\"]+\.)+[^<>()[\]\.,;:\s@\"]{2,})$/i;
    clearAlertsInForm(objEmail);

    if(regex.test(strEmail)) {
        objEmail.classList.add('am-form-success');
        return true;
    } else {
        objEmail.classList.add('am-form-danger');
        return false;
    }
}

function validatePhone(objPhone, strPhone) {
    clearAlertsInForm(objPhone);

    if(strPhone != '' && strPhone.length === 10 && !isNaN(strPhone)) {
        objPhone.classList.add('am-form-success');
        return true;
    } else {
        objPhone.classList.add('am-form-danger');
        return false;
    }
}

function clearAlertsInForm(e) {
    e.classList.remove('am-form-success');
    e.classList.remove('am-form-danger');
}

function sendContactForm() {
    $('#contactForm')[0].classList.add('uk-hidden');
    $('#contactSuccess')[0].classList.remove('uk-hidden');
}

function showNotification(message, type, position) {
    UIkit.notify(message, {status: type, timeout: 3000, position: position});
}

function validateRemolqueForm() {
    var frmSalida = $('#cotOpt2Salida')[0];
    var frmPeso = $('#cotOpt2Peso')[0];
    var frmEslora = $('#cotOpt2Esolra')[0];
    var frmCalado = $('#cotOpt2Calado')[0];
    var frmTRB = $('#cotOptTRB')[0];
    var frmEntrada = $('#cotOpt2Entrada')[0];
    var frmDesplazamiento = $('#cotOpt2Desplazamiento')[0];
    var frmCondicion = $('#cotOpt2Condicion')[0];
    
    var vSalida = validateSalida(frmSalida, frmSalida.value);
    var vPeso = validatePeso(frmPeso, frmPeso.value);
    var vEslora = validateEslora(frmEslora, frmEslora.value);
    var vCalado = validateCalado(frmCalado, frmCalado.value);
    var vTRB = validateTRB(frmTRB, frmTRB.value);
    var vEntrada = validateEntrada(frmEntrada, frmEntrada.value);
    var vDesplazamiento = validateDesplazamiento(frmDesplazamiento, frmDesplazamiento.value);
    var vCondicion = validateCondicion(frmCondicion, frmCondicion.value);

    if(vSalida && vPeso && vEslora && vEslora && vCalado && vTRB && vEntrada && vDesplazamiento && vCondicion) {
        return true;
    } else {
        showNotification(LNG.err.fail_validation, NOTIFY_STS.FAIL, NOTIFY_POS.TOP_CENTER);
        return false;
    }
}

function validateSalida(objSalida, strSalida) {
    clearAlertsInForm(objSalida);

    if(strSalida != '' && strSalida.length >= 5 && isNaN(strSalida)) {
        objSalida.classList.add('am-form-success');
        return true;
    } else {
        objSalida.classList.add('am-form-danger');
        return false;
    }
}

function validatePeso(objPeso, strPeso) {
    clearAlertsInForm(objPeso);

    if(strPeso != '') {
        objPeso.classList.add('am-form-success');
        return true;
    } else {
        objPeso.classList.add('am-form-danger');
        return false;
    }
}

function validatePeso(objPeso, strPeso) {
    clearAlertsInForm(objPeso);

    if(strPeso != '') {
        objPeso.classList.add('am-form-success');
        return true;
    } else {
        objPeso.classList.add('am-form-danger');
        return false;
    }
}

function validateEslora(objEslora, strEslora) {
    clearAlertsInForm(objEslora);

    if(strEslora != '') {
        objEslora.classList.add('am-form-success');
        return true;
    } else {
        objEslora.classList.add('am-form-danger');
        return false;
    }
}

function validateCalado(objCalado, strCalado) {
    clearAlertsInForm(objCalado);

    if(strCalado != '') {
        objCalado.classList.add('am-form-success');
        return true;
    } else {
        objCalado.classList.add('am-form-danger');
        return false;
    }
}

function validateTRB(objTRB, strTRB) {
    clearAlertsInForm(objTRB);

    if(strTRB != '') {
        objTRB.classList.add('am-form-success');
        return true;
    } else {
        objTRB.classList.add('am-form-danger');
        return false;
    }
}

function validateEntrada(objEntrada, strEntrada) {
    clearAlertsInForm(objEntrada);

    if(strEntrada != '') {
        objEntrada.classList.add('am-form-success');
        return true;
    } else {
        objEntrada.classList.add('am-form-danger');
        return false;
    }
}

function validateDesplazamiento(objDesplazamiento, strDesplazamiento) {
    clearAlertsInForm(objDesplazamiento);

    if(strDesplazamiento != '') {
        objDesplazamiento.classList.add('am-form-success');
        return true;
    } else {
        objDesplazamiento.classList.add('am-form-danger');
        return false;
    }
}

function validateCondicion(objCondicion, strCondicion) {
    clearAlertsInForm(objCondicion);

    if(strCondicion != '') {
        objCondicion.classList.add('am-form-success');
        return true;
    } else {
        objCondicion.classList.add('am-form-danger');
        return false;
    }
}